(function(){window.randomInt=function(b,c){var e,d,a;if(c==null){c=0}e=Math.random();if(!(b!=null)){d=[0,b],b=d[0],c=d[1]}if(b>c){a=[c,b],b=a[0],c=a[1]}return Math.floor(e*(c-b+1)+b)};window.logWithBase=function(b,a){return Math.log(a)/Math.log(b)};window.decimalAdjust=function(a,b,c){if(typeof c==="undefined"||+c===0){return Math[a](b)}b=+b;c=+c;if(isNaN(b)||!(typeof c==="number"&&c%1===0)){return NaN}b=b.toString().split("e");b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-c:-c)));b=b.toString().split("e");return +(b[0]+"e"+(b[1]?+b[1]+c:c))};if(!(Math.round10!=null)){Math.round10=function(a,b){return decimalAdjust("round",a,b)}}if(!(Math.floor10!=null)){Math.floor10=function(a,b){return decimalAdjust("floor",a,b)}}if(!(Math.ceil10!=null)){Math.ceil10=function(a,b){return decimalAdjust("ceil",a,b)}}window.numberSuffixed=function(a,d){var c,b;b="";if(a>=1000000000){b="g";a/=1000000000}else{if(a>=1000000){b="m";a/=1000000}else{if(a>=1000){b="k";a/=1000}}}c=Math.round10(a,d);return c+b}}).call(this);(function(){var a=this;window.Audanism={Audio:{FX:{},Instrument:{},Module:{},Synthesizer:{}},Calculator:{},Environment:{},Event:{},Factor:{},Graphic:{},GUI:{},Node:{},SourceAdapter:{},Util:{}};$(window).ready(function(){return window.Audanism.appInstance=new Audanism.Environment.Environment})}).call(this);(function(){window.clone=function(d){var a,c,b;if(d instanceof Date){return new Date(d.getTime())}if(d instanceof RegExp){a="";if(d.global!=null){a+="g"}if(d.ignoreCase!=null){a+="i"}if(d.multiline!=null){a+="m"}if(d.sticky!=null){a+="y"}return new RegExp(d.source,a)}b=new d.constructor();for(c in d){b[c]=d[c]}return b};window.clone=clone}).call(this);(function(){window.Math.randomRange=function(a,b){if(a==null){a=null}if(b==null){b=null}if(!(a!=null)&&!(b!=null)){return Math.random()}if(b==null){b=0}return b+Math.floor(Math.random()*(a-b+1))}}).call(this);(function(){var b,a;a=function(c,g){var h,f,e,d;d=[];for(f=0,e=g.length;f<e;f++){h=g[f];d.push(c.push(h))}return d};window.pushMany=a;b=function(d,c){var h,f,e,g;h=(function(){var k,j,i;i=[];for(k=0,j=d.length;k<j;k++){g=d[k];i.push(g)}return i})();return f=(function(){var j,i;i=[];for(e=j=1;1<=c?j<=c:j>=c;e=1<=c?++j:--j){i.push(h.splice(Math.floor(Math.random()*h.length),1)[0])}return i})()};window.getRandomElements=b;Array.prototype.shuffle=function(){var c,e,d;c=this.length;d;e;while(c>0){e=Math.floor(Math.random()*c);c--;d=this[c];this[c]=this[e];this[e]=d}return this}}).call(this);(function(){var a;a=(function(){function b(){}b.prototype.getNumCharsInGroups=function(p,h,o){var v,r,w,n,k,s,q,c,m,j,y,g,f,e,d,t,x,u,l;n=p.split("");m=26;s=(function(){var A,z,i;i=[];for(q=A=0,z=h-1;0<=z?A<=z:A>=z;q=0<=z?++A:--A){i.push(0)}return i})();k=null;o=o!=null?o:true;for(g=0,t=n.length;g<t;g++){v=n[g];w=v.toUpperCase().charCodeAt(0)-65;if(w>=m||w<0){continue}r=Math.floor(w/(m/h));s[r]=s[r]+1}if(o){j=0;for(f=0,x=s.length;f<x;f++){q=s[f];j+=q}k=(function(){var A,i,z;z=[];for(A=0,i=s.length;A<i;A++){q=s[A];z.push(q/j)}return z})();c=-1;for(e=0,u=k.length;e<u;e++){y=k[e];if(y>c){c=y}}for(q=d=0,l=k.length-1;0<=l?d<=l:d>=l;q=0<=l?++d:--d){y=k[q];k[q]=y/c}}if(o){return k}else{return s}};return b})();window.Audanism.Util.TextInterpreter=a}).call(this);(function(){var a;a=(function(){function b(){}b.prototype.on=function(c,f,d){var e=this;if(d){f.bind(d)}return $(document).on(c,function(g){return f.apply(null,arguments.slice(1))})};b.prototype.listen=function(c,d,f){var e=this;return $(document).on(c,function(g){return f.call(d,arguments[1])})};b.prototype.trigger=function(c,d){return $(document).trigger(c,d)};return b})();window.Audanism.Event.EventDispatcher=a;window.EventDispatcher=new a()}).call(this);(function(){var a;a=(function(){b._idCounter=0;b.NUM_CELLS=2;b.prototype.clone=function(){var c,e,d;d=new Audanism.Node.Node;b._idCounter--;for(e in this){d[e]=this[e]}d._cells=(function(){var i,g,h,f;h=d._cells;f=[];for(i=0,g=h.length;i<g;i++){c=h[i];f.push(c.clone())}return f})();return d};function b(){var g,d,f,e,c;this.nodeId=b._idCounter++;g=(function(){c=[];for(var i=1,h=Audanism.Environment.Organism.NUM_FACTORS;1<=h?i<=h:i>=h;1<=h?i++:i--){c.push(i)}return c}).apply(this);this._cells=(function(){var j,h,i;i=[];for(d=j=1,h=Audanism.Node.Node.NUM_CELLS;1<=h?j<=h:j>=h;d=1<=h?++j:--j){i.push(new Audanism.Node.NodeCell(g.splice(Math.floor(Math.random()*g.length),1)[0],0))}return i})();this._cells.sort(function(i,h){return i.factorType>h.factorType})}b.prototype.getCells=function(){return this._cells};b.prototype.getCell=function(f){e;var c,e,h,d,g;g=this._cells;for(h=0,d=g.length;h<d;h++){c=g[h];if(c.factorType===f){e=c;break}}return e};b.prototype.hasCellOfFactorType=function(e){var c,f,h,d,g;f=false;g=this._cells;for(h=0,d=g.length;h<d;h++){c=g[h];f=f||c.factorType===e}return f};b.prototype.getCellValue=function(d){var c;c=this.getCell(d);if(c){return c.factorValue}else{return 0}};b.prototype.setCellValue=function(d,e){var c;c=this.getCell(d);c.factorValue=e;if(c.factorValue<0){c.factorValue=0}if(c.factorValue>100){return c.factorValue=100}};b.prototype.addCellValue=function(c,d){return this.setCellValue(c,this.getCellValue(c)+d)};b.prototype.getCellValues=function(e){var c,d;if(e==null){e=false}d=(function(){var i,g,h,f;h=this._cells;f=[];for(i=0,g=h.length;i<g;i++){c=h[i];f.push(c.factorValue)}return f}).call(this);if(e){return d.join(" ")}else{return d}};b.prototype.getString=function(){return"#"+this.nodeId+" {"+(this.getCellValues(true))+"}"};b.prototype.toString=function(){return this.getString()};return b})();window.Audanism.Node.Node=a}).call(this);(function(){var a;a=(function(){b.prototype.clone=function(){return new Audanism.Node.NodeCell(this.factorType,this.factorValue)};function b(c,d){this.factorType=c;this.factorValue=d}b.prototype.addFactorValue=function(c){this.factorValue+=c;if(this.factorValue<0){this.factorValue=0}if(this.factorValue>100){return this.factorValue=100}};return b})();window.Audanism.Node.NodeCell=a}).call(this);(function(){var a;a=(function(){b.NUM_FACTORS=5;b.DEFAULT_NUM_NODES=10;b.DISTRIBUTE_FACTOR_VALUES=false;b.STRESS_THRESHOLD_ENTER=1;b.STRESS_THRESHOLD_LEAVE=2;function b(d){var c,e=this;if(d==null){d=-1}this._sumDisharmony=0;this._actualDisharmony=0;this._inStressMode=false;this.stress={thresholdEnter:0,thresholdLeave:0};EventDispatcher.trigger("audanism/organism/stressmode",this._inStressMode);this._stressAdjustmentTime=8000;this._stressAdjustmentInterval=setInterval(this.adjustStressThresholds.bind(this),this._stressAdjustmentTime);this._factors=(function(){var h,g,f;f=[];for(c=h=1,g=Audanism.Environment.Organism.NUM_FACTORS;1<=g?h<=g:h>=g;c=1<=g?++h:--h){f.push(Audanism.Factor.Factor.createFactor(c,0))}return f})();EventDispatcher.trigger("audanism/init/factors",[this._factors]);if(d<=0){d=Audanism.Environment.Organism.DEFAULT_NUM_NODES}this._createNodes(d);EventDispatcher.trigger("audanism/init/nodes",[this._nodes]);EventDispatcher.listen("audanism/node/add",this,function(f){return e._createNodes(f.numNodes)});this.disharmonyCalculator=new Audanism.Calculator.DisharmonyCalculator(this);this.disharmonyHistory=[]}b.prototype.getNode=function(c){if(this._nodes[c]!=null){return this._nodes[c]}else{return null}};b.prototype.getNodesWithCellsOfFactorType=function(c){return this._nodeCellIndex[c]};b.prototype.getNodes=function(){return this._nodes};b.prototype.getFactors=function(){return this._factors};b.prototype.getFactorOfType=function(e){var d,h,g,c,f;h=null;f=this._factors;for(g=0,c=f.length;g<c;g++){d=f[g];if(d.factorType===e){h=d}}return h};b.prototype.performNodeComparison=function(d){var k,j,h,c,f,e,l,g;if(d==null){d=1}this.isInitialComparison=this._sumDisharmony===0;this.disharmonyCalculator.debug=true;for(h=f=1;1<=d?f<=d:f>=d;h=1<=d?++f:--f){c=this._getRandomNodes(2);k=this._inStressMode&&false?Audanism.Calculator.DisharmonyCalculator.NODE_COMPARISON_MODE_FACTOR_HARMONY:Audanism.Calculator.DisharmonyCalculator.NODE_COMPARISON_MODE_ORGANISM_HARMONY;EventDispatcher.trigger("audanism/compare/nodes",[{nodes:c,comparisonMode:k}]);this.disharmonyCalculator.alterNodesInComparisonMode(c,k)}this.disharmonyCalculator.debug=false;this._sumDisharmony=this.disharmonyCalculator.getSummedOrganismDisharmony(this);this._actualDisharmony=this.disharmonyCalculator.getActualOrganismDisharmony(this);this.disharmonyHistory.push([this.disharmonyHistory.length,this._sumDisharmony,this._actualDisharmony]);g=this._factors;for(e=0,l=g.length;e<l;e++){j=g[e];j.setDisharmony(this.disharmonyCalculator.getFactorDisharmonyForNodes(j,this._nodes))}if(this.isInitialComparison){this.stress.thresholdEnter=this._actualDisharmony*1.2}if(!this._inStressMode&&this._actualDisharmony>this.stress.thresholdEnter){this._inStressMode=true;this.stress.thresholdLeave=this.stress.thresholdEnter*1;EventDispatcher.trigger("audanism/organism/stressmode",this._inStressMode);clearInterval(this._stressAdjustmentInterval);return this._stressAdjustmentInterval=setInterval(this.adjustStressThresholds.bind(this),this._stressAdjustmentTime)}else{if(this._inStressMode&&this._actualDisharmony<this.stress.thresholdLeave){this._inStressMode=false;this.stress.thresholdEnter=this.stress.thresholdLeave*1.2;EventDispatcher.trigger("audanism/organism/stressmode",this._inStressMode);clearInterval(this._stressAdjustmentInterval);return this._stressAdjustmentInterval=setInterval(this.adjustStressThresholds.bind(this),this._stressAdjustmentTime)}}};b.prototype.getDisharmonyHistoryData=function(c){if(c==null){c=300}if(c>0){return this.disharmonyHistory.slice(-c)}else{return this.disharmonyHistory.slice(-this.disharmonyHistory.length)}};b.prototype.getAverageDisharmony=function(i,e){var f,h,d,g,c;if(e==null){e="sum"}h=this.getDisharmonyHistoryData(i);d=0;for(g=0,c=h.length;g<c;g++){f=h[g];d+=(e==="actual"?f[2]:f[1])}return d/h.length};b.prototype.getDisharmonyChange=function(c,e){var d,f;if(c==null){c=2}if(e==null){e="sum"}f=this.getDisharmonyHistoryData(c);d=e==="actual"?2:1;return f[f.length-1][d]/f[0][d]};b.prototype.getDisharmonyChangeForFactor=function(e,c){var d,f;if(c==null){c=2}d=this.getFactorOfType(e);f=d.disharmonyHistory.slice(c<d.disharmonyHistory.length?-c:0);return f[f.length-1]/f[0]};b.prototype.adjustStressThresholds=function(){if(this._inStressMode){return this.stress.thresholdLeave=this._actualDisharmony*1}else{return this.stress.thresholdEnter=this._actualDisharmony*1.2}};b.prototype._createNodes=function(q){var f,p,t,s,r,o,j,g,e,d,w,z,y,x,v,u,c,A,n,l,k,h,m;if(!this._nodeCellIndex){this._nodeCellIndex=[];n=this._factors;for(j=0,w=n.length;j<w;j++){p=n[j];this._nodeCellIndex[p.factorType]=[]}}if(!this._nodes){this._nodes=[]}r=(function(){var B,i;i=[];for(t=B=1;1<=q?B<=q:B>=q;t=1<=q?++B:--B){i.push(new Audanism.Node.Node())}return i})();for(g=0,z=r.length;g<z;g++){s=r[g];this._nodes[s.nodeId]=s}for(e=0,y=r.length;e<y;e++){s=r[e];l=s.getCells();for(d=0,x=l.length;d<x;d++){f=l[d];this._nodeCellIndex[f.factorType].push(s)}}if(b.DISTRIBUTE_FACTOR_VALUES){k=this._factors;h=[];for(c=0,v=k.length;c<v;c++){p=k[c];o=this.getNodesWithCellsOfFactorType(p.factorType);h.push((function(){var i,C,B;B=[];for(t=i=1,C=p.factorValue;1<=C?i<=C:i>=C;t=1<=C?++i:--i){B.push(getRandomElements(o,1)[0].addCellValue(p.factorType,1))}return B})())}return h}else{m=[];for(A=0,u=r.length;A<u;A++){s=r[A];m.push((function(){var C,i,D,B;D=s.getCells();B=[];for(i=0,C=D.length;i<C;i++){f=D[i];B.push(f.factorValue=Math.randomRange(0,100))}return B})())}return m}};b.prototype._getRandomNodes=function(c){var m,k,d,h,g,l,j,f,e;m=(function(){f=[];for(var n=0,i=this._nodes.length-1;0<=i?n<=i:n>=i;0<=i?n++:n--){f.push(n)}return f}).apply(this);d=(function(){var n,i;i=[];for(k=n=1;1<=c?n<=c:n>=c;k=1<=c?++n:--n){i.push(m.splice(Math.floor(Math.random()*m.length),1))}return i})();e=[];for(g=0,l=d.length;g<l;g++){k=d[g];e.push(this._nodes[k])}return e};b.prototype._getRandomNodesOfFactorType=function(d,c){return getRandomElements(this._nodeCellIndex[d],c)};return b})();window.Audanism.Environment.Organism=a}).call(this);(function(){var a;a=(function(){b.NUM_ORGANISMS=1;b.TIME_INTERVAL=500;function b(){var c;this._iterationCount=0;this._isRunning=false;this._isSingleStep=false;this.visualOrganism=new Audanism.Graphic.VisualOrganism();this._organisms=(function(){var f,e,d;d=[];for(c=f=1,e=b.NUM_ORGANISMS;1<=e?f<=e:f>=e;c=1<=e?++f:--f){d.push(new Audanism.Environment.Organism)}return d})();EventDispatcher.trigger("audanism/init/organism",[this._organisms[0]]);this._gui=new Audanism.GUI.GUI;this.listenToControls();this.createInfluenceSources();EventDispatcher.listen("audanism/influence",this,this.influence);this.initConductor();this.run();EventDispatcher.listen("audanism/controls/start",this,this.start);EventDispatcher.listen("audanism/controls/pause",this,this.pause);EventDispatcher.listen("audanism/controls/stop",this,this.stop);EventDispatcher.listen("audanism/controls/step",this,this.step)}b.prototype.run=function(){var c=this;return this._intervalId=setInterval(function(){return c.handleIteration()},b.TIME_INTERVAL)};b.prototype.start=function(){var c,g,e,f,d;this._isRunning=true;f=this._influenceSources;d=[];for(g=0,e=f.length;g<e;g++){c=f[g];d.push(c.activate())}return d};b.prototype.pause=function(){var g,f,d,e,c;this._isRunning=false;e=this._influenceSources;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(g.deactivate())}return c};b.prototype.stop=function(){this._isRunning=false;return clearInterval(this._intervalId)};b.prototype.step=function(){return this._isSingleStep=true};b.prototype.listenToControls=function(){var c=this;$(document).on("dmstart",function(d){return EventDispatcher.trigger("audanism/controls/start")});$(document).on("dmpause",function(d){return EventDispatcher.trigger("audanism/controls/pause")});$(document).on("dmstop",function(d){return EventDispatcher.trigger("audanism/controls/stop")});return $(document).on("dmstep",function(d){return EventDispatcher.trigger("audanism/controls/step")})};b.prototype.handleIteration=function(){var g,f,d,e,c;this._iterationCount++;if(this._isRunning||this._isSingleStep){e=this._organisms;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];g.performNodeComparison();if(this._iterationCount%10===0){EventDispatcher.trigger("audanism/node/add",{numNodes:1})}EventDispatcher.trigger("audanism/iteration",[{count:this._iterationCount,organism:g}]);c.push(this._isSingleStep=false)}return c}else{}};b.prototype.createInfluenceSources=function(){this._influenceSources=[];this._influenceSources.push(new Audanism.SourceAdapter.InstagramSourceAdapter(6000,"art"));this._influenceSources.push(new Audanism.SourceAdapter.InstagramSourceAdapter(3000,"audanism"));return this._influenceSources.push(new Audanism.SourceAdapter.WheatherSourceAdapter(4000))};b.prototype.influence=function(e){var m,y,g,u,o,s,C,w,v,q,D,z,n,x,r,j,f,d,c,B,F,E,A,t,l,k,i,h,p;if(!this._isRunning){return}if(e.node!=null){t=this._organisms;for(j=0,B=t.length;j<B;j++){z=t[j];u=e.node.factor==="rand"?getRandomElements(z.getFactors()):z.getFactorOfType(e.node.factor);w=e.node.node==="rand"?z._getRandomNodesOfFactorType(u.factorType,1)[0]:z.getNode(e.node.node);C={node:{node:w,factor:u,value:e.node.valueModifier},meta:e.meta};EventDispatcher.trigger("audanism/influence/node",[C]);w.addCellValue(u.factorType,e.node.valueModifier);EventDispatcher.trigger("audanism/influence/node/after",[C])}}if(e.factor!=null){l=this._organisms;for(f=0,F=l.length;f<F;f++){z=l[f];u;if(e.factor.factor==="rand"){o=randomInt(1,Audanism.Environment.Organism.NUM_FACTORS);u=z.getFactorOfType(o)}if(u){C={factor:{factor:u,value:e.factor.valueModifier},meta:e.meta};EventDispatcher.trigger("audanism/influence/factor",C);u.addValue(e.factor.valueModifier);EventDispatcher.trigger("audanism/influence/factor/after",C)}}}if(e.random!=null){n=e.random.object;m=e.random.num;y=e.random.valueModifier;q=0;r=-1;D=typeof m;if(D==="integer"){q=m}else{if(D==="array"){q=Math.randomRange(m[1],m[0])}else{if(D==="string"&&m==="rand"){q=Math.randomRange(n==="factor"?1:5)}}}if(n==="factor"){k=this._organisms;h=[];for(d=0,E=k.length;d<E;d++){z=k[d];s=getRandomElements(z.getFactors(),q);h.push((function(){var H,I,G;G=[];for(H=0,I=s.length;H<I;H++){u=s[H];x=typeof y;if(x==="integer"){r=y}else{if(x==="array"){r=Math.randomRange(y[1],y[0])}else{if(x==="string"&&y==="rand"){r=Math.randomRange(5,-5)}}}G.push(z.getFactorOfType(u.factorType).addValue(r))}return G})())}return h}else{if(n==="node"){i=this._organisms;p=[];for(c=0,A=i.length;c<A;c++){z=i[c];v=getRandomElements(z.getNodes(),q);p.push((function(){var I,H,G;G=[];for(H=0,I=v.length;H<I;H++){w=v[H];x=typeof y;if(x==="integer"){r=y}else{if(x==="array"){r=Math.randomRange(y[1],y[0])}else{if(x==="string"&&y==="rand"){r=Math.randomRange(50,-50)}}}g=getRandomElements(w.getCells(),1)[0];G.push(g.addFactorValue(r))}return G})())}return p}}}};b.prototype.initConductor=function(){this.conductor=new Audanism.Audio.Conductor();return this.conductor.setOrganism(this._organisms[0])};return b})();window.Audanism.Environment.Environment=a}).call(this);(function(){var a;a=(function(){function b(c){this.sourceAdapters=c}b.prototype.addSourceAdapter=function(c){};b.prototype.startListenToSources=function(){};return b})();window.Audanism.Environment.Interpreter=a}).call(this);(function(){var a;a=(function(){b.TYPE_UNKNOWN=0;b.TYPE_OPENNESS=1;b.TYPE_CONSCIENTIOUSNESS=2;b.TYPE_EXTRAVERSION=3;b.TYPE_AGREEABLENESS=4;b.TYPE_NEUROTICISM=5;b.FACTOR_CORRELATIONS={"1":{"2":-15,"3":25},"2":{"3":30},"3":{"4":50},"4":{"5":-20}};b.createFactor=function(c,d){if(d==null){d=0}switch(c){case b.TYPE_OPENNESS:return new Audanism.Factor.OpennessFactor();case b.TYPE_CONSCIENTIOUSNESS:return new Audanism.Factor.ConscientiousnessFactor();case b.TYPE_EXTRAVERSION:return new Audanism.Factor.ExtraversionFactor();case b.TYPE_AGREEABLENESS:return new Audanism.Factor.AgreeablenessFactor();case b.TYPE_NEUROTICISM:return new Audanism.Factor.NeuroticismFactor();default:return null}};function b(c,d){this.factorType=c;this.factorValue=d;if(!this.factorValue){this.factorValue=randomInt(10,90)}this.name=this.constructor.name.replace(/^(\w+)Factor$/,"$1");this.disharmony=0;this.relativeDisharmony=[];this.disharmonyHistory=[]}b.prototype.addValue=function(c){this.factorValue+=c;if(this.factorValue<0){this.factorValue=0}if(this.factorValue>100){return this.factorValue=100}};b.prototype.setDisharmony=function(c){this.disharmony=c;return this.disharmonyHistory.push(c)};b.prototype.toString=function(){return"<Factor #"+this.factorType+" ("+this.name+"); factorValue = "+this.factorValue+">"};return b})();window.Audanism.Factor.Factor=a}).call(this);(function(){var a,b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};a=(function(e){c(d,e);function d(){d.__super__.constructor.call(this,Audanism.Factor.Factor.TYPE_AGREEABLENESS)}return d})(Audanism.Factor.Factor);window.Audanism.Factor.AgreeablenessFactor=a}).call(this);(function(){var b,a={}.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};b=(function(e){c(d,e);function d(){d.__super__.constructor.call(this,Audanism.Factor.Factor.TYPE_CONSCIENTIOUSNESS)}return d})(Audanism.Factor.Factor);window.Audanism.Factor.ConscientiousnessFactor=b}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(d){b(e,d);function e(){e.__super__.constructor.call(this,Audanism.Factor.Factor.TYPE_EXTRAVERSION)}return e})(Audanism.Factor.Factor);window.Audanism.Factor.ExtraversionFactor=c}).call(this);(function(){var a,b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};a=(function(e){c(d,e);function d(){d.__super__.constructor.call(this,Audanism.Factor.Factor.TYPE_NEUROTICISM)}return d})(Audanism.Factor.Factor);window.Audanism.Factor.NeuroticismFactor=a}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(d){b(e,d);function e(){e.__super__.constructor.call(this,Audanism.Factor.Factor.TYPE_OPENNESS)}return e})(Audanism.Factor.Factor);window.Audanism.Factor.OpennessFactor=c}).call(this);(function(){var a;a=(function(){b.NODE_COMPARISON_MODE_UNKNOWN=0;b.NODE_COMPARISON_MODE_FACTOR_HARMONY=1;b.NODE_COMPARISON_MODE_ORGANISM_HARMONY=2;b.NODE_ACTION_MOVE_VALUE_NONE=3;b.NODE_ACTION_MOVE_VALUE_1=4;b.NODE_ACTION_MOVE_VALUE_2=5;b.NODE_ACTION_SAVE_VALUE_1=6;b.NODE_ACTION_SAVE_VALUE_2=7;b.NODE_ACTION_SAVE_BOTH=8;function b(c,d){this._organism=c;this.debug=d!=null?d:false}b.prototype.getSummedOrganismDisharmony=function(){var d,e,h,g,c,f;h=0;f=this._organism.getFactors();for(g=0,c=f.length;g<c;g++){e=f[g];h+=this.getFactorDisharmonyForNodes(e,this._organism.getNodes())}d=h/this._organism.getNodes().length;return h};b.prototype.getActualOrganismDisharmony=function(){var d,c,q,h,m,n,o,e,k,j,g,p,l,i,f;m=[];l=this._organism.getFactors();for(k=0,p=l.length;k<p;k++){o=l[k];m[o.factorType]=this.getFactorDisharmonyForNodes(o,this._organism.getNodes())}h=Audanism.Factor.Factor.FACTOR_CORRELATIONS;for(e=j=1,i=Audanism.Environment.Organism.NUM_FACTORS;1<=i?j<=i:j>=i;e=1<=i?++j:--j){for(c=g=1,f=Audanism.Environment.Organism.NUM_FACTORS;1<=f?g<=f:g>=f;c=1<=f?++g:--g){if((h[e]!=null)&&(h[e][c]!=null)){q=h[e][c];n=Math.abs(m[e]-m[c]);m[e]+=Math.pow(n,2.2)*(100-q)/(100*n)}}}d=m.reduce(function(s,r){return s+r});return d};b.prototype.getFactorDisharmonyForNodes=function(f,e){var d,g,h,c;d=0;for(h=0,c=e.length;h<c;h++){g=e[h];if(g.hasCellOfFactorType(f.factorType)){d+=this.getFactorDisharmonyForNode(f,g)}}return d};b.prototype.getFactorDisharmonyForNode=function(e,f){var c,d,g;d=0;c=f.getCell(e.factorType);if(!c){return}if((0<=(g=c.factorValue)&&g<=e.factorValue)){d=this._calcFactorDisharmonyForNode_lteF(c.factorValue,e.factorValue)}else{d=this._calcFactorDisharmonyForNode_gtF(c.factorValue,e.factorValue)}return d};b.prototype.getRelativeDisharmonyForFactors=function(c){};b.prototype.alterNodesInComparisonMode=function(u,n){var k,w,f,m,r,y,s,l,t,j,h,v,q,x,p,g,e,d,c,A,C,B,z,o,i;r=n===Audanism.Calculator.NODE_COMPARISON_MODE_FACTOR_HARMONY?"getFactorDisharmonyForNodes":"getActualOrganismDisharmony";m=[];o=u[0].getCells();for(g=0,A=o.length;g<A;g++){k=o[g];i=u[1].getCells();for(e=0,C=i.length;e<C;e++){w=i[e];if(k.factorType===w.factorType){m.push(k.factorType)}}}for(d=0,B=m.length;d<B;d++){l=m[d];p=u;q;t=false;for(c=0,z=u.length;c<z;c++){v=u[c];f=v.getCell(l);if(f.factorValue===0){v.addCellValue(l,1);t=true}if(f.factorValue===100){v.addCellValue(l,-1);t=true}if(t){return}}s=this._organism.getFactorOfType(l);y=this[r](s,p);p[0].addCellValue(l,-1);p[1].addCellValue(l,1);j=this[r](s,p);p[0].addCellValue(l,2);p[1].addCellValue(l,-2);h=this[r](s,p);p[0].addCellValue(l,-1);p[1].addCellValue(l,1);x=j<h?j:h;q=j<h?Audanism.Calculator.DisharmonyCalculator.NODE_ACTION_MOVE_VALUE_1:Audanism.Calculator.DisharmonyCalculator.NODE_ACTION_MOVE_VALUE_2;this._performAction(u,l,q)}return true};b.prototype._performAction=function(c,d,e){switch(e){case Audanism.Calculator.DisharmonyCalculator.NODE_ACTION_MOVE_VALUE_1:c[0].addCellValue(d,-1);c[1].addCellValue(d,1);break;case Audanism.Calculator.DisharmonyCalculator.NODE_ACTION_MOVE_VALUE_2:c[0].addCellValue(d,1);c[1].addCellValue(d,-1)}return EventDispatcher.trigger("audanism/alter/nodes",[{nodes:c,factorType:d,action:e}])};b.prototype._calcFactorDisharmonyForNode_lteF=function(f,e){var d;d=-(Math.pow(f,2))/(Math.pow(e,2))+1;d=Math.pow(d,6);d=Math.pow(d+1,10);return d};b.prototype._calcFactorDisharmonyForNode_gtF=function(f,e){var d;d=-((f-e)*(f-200+e))/Math.pow(100-e,2);d=Math.pow(d,6);d=Math.pow(d+1,10);return d};return b})();window.Audanism.Calculator.DisharmonyCalculator=a}).call(this);(function(){var a;a=(function(){function b(d,c){this.sourceId=d;this.interval=c!=null?c:5000;this.active=false}b.prototype.activate=function(){return this.active=true};b.prototype.deactivate=function(){return this.active=false};b.prototype.setInterval=function(c){this.interval=c};b.prototype.getAdaptedSourceData=function(d){var c;return c={factors:[{factor:null,valueModifier:null}],node:[{node:null,factorType:null,valueModifier:0}],random:[{object:"node",num:[0,1],valueModifier:[0,1]}]}};b.prototype.triggerInfluence=function(c){if(this.listener.influence!=null){return this.listener.influence(c)}};return b})();window.Audanism.SourceAdapter.SourceAdapter=a}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(d){b(e,d);e.TIME_INTERVAL_ALTER_FACTORS=2000;e.PROBABILITY_ALTER_FACTORS=1;e.TIME_INTERVAL_ALTER_NODES=500;e.PROBABILITY_ALTER_NODES=1;function e(f){this.listener=f;e.__super__.constructor.call(this,this.listener)}e.prototype.activate=function(){var f=this;setInterval(function(){return f.tryAlterFactors()},e.TIME_INTERVAL_ALTER_FACTORS);return setInterval(function(){return f.tryAlterNodes()},e.TIME_INTERVAL_ALTER_NODES)};e.prototype.getAdaptedSourceData=function(f){return f};e.prototype.tryAlterFactors=function(){if(Math.floor((Math.random()+1)/e.PROBABILITY_ALTER_FACTORS)===1){return this.triggerInfluence({random:{object:"factor",num:1,valueModifier:"rand"}})}};e.prototype.tryAlterNodes=function(){if(Math.randomRange(Math.round(1/e.PROBABILITY_ALTER_NODES))===1){return this.triggerInfluence({random:{object:"node",num:"rand",valueModifier:"rand"}})}};return e})(Audanism.SourceAdapter.SourceAdapter);window.Audanism.SourceAdapter.RandomSourceAdapter=c}).call(this);(function(){var a,b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};a=(function(e){c(d,e);function d(g,f){this.interval=g!=null?g:5000;this.tag=f!=null?f:"audanism";d.__super__.constructor.call(this,"instagram",this.interval);this.clientId="f42a4ce0632e412ea5a0353c2b5e581f";this.photoSinceId=0;this.queryUrl="https://api.instagram.com/v1/tags/"+this.tag+"/media/recent";this.jqxhr=null}d.prototype.activate=function(){var f=this;this.active=true;return this.queryInterval=setInterval(function(){return f.queryPhotos()},this.interval)};d.prototype.deactive=function(){this.active=false;return clearInterval(this.queryInterval)};d.prototype.queryPhotos=function(){var f=this;if(this.jqxhr||!this.active){return}return this.jqxhr=$.ajax({dataType:"jsonp",url:this.queryUrl,data:{client_id:this.clientId,count:1,max_id:this.photoSinceId},success:function(g){return f.processPhotos(g.data)}})};d.prototype.processPhotos=function(o){var p,h,m,g,q,r,s,f,k,j,n,l;r=new Audanism.Util.TextInterpreter;q=[];for(k=0,n=o.length;k<n;k++){f=o[k];if(f.id===this.photoSinceId){continue}this.photoSinceId=f.id;if(!f.caption){continue}p=f.caption.text;h=r.getNumCharsInGroups(p,5);for(m=j=0,l=h.length-1;0<=l?j<=l:j>=l;m=0<=l?++j:--j){if(!h[m]){continue}s=Math.round(h[m]*20);s=Math.random()>=0.5?-s:s;g={node:{node:"rand",factor:m+1,valueModifier:s},meta:{current:m+1,total:h.length,source:this.sourceId,sourceData:f}};q.push(g);EventDispatcher.trigger("audanism/influence",g)}}if(q.length>0){EventDispatcher.trigger("audanism/influence/node/done",[q])}return this.jqxhr=null};return d})(Audanism.SourceAdapter.SourceAdapter);window.Audanism.SourceAdapter.InstagramSourceAdapter=a}).call(this);(function(){var a,b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};a=(function(e){c(d,e);function d(f){this.interval=f!=null?f:5000;d.__super__.constructor.call(this,"weather",this.interval);this.queryUrl="http://www.yr.no/place/%s/%s/%s/forecast.xml";this.jqxhr=null;this.queryInterval;this.towns=null}d.prototype.activate=function(){var f=this;this.active=true;return this.queryInterval=setInterval(function(){return f.queryWeather()},this.interval)};d.prototype.deactive=function(){this.active=false;return clearInterval(this.queryInterval)};d.prototype.fetchTowns=function(){var f=this;return $.ajax({url:"/js/data/yr-capitals.json",dataType:"json",success:function(g){return f.towns=g},error:function(g){return console.error(g)}})};d.prototype.getATown=function(){if(this.towns){return this.towns[randomInt(0,this.towns.length-1)]}return null};d.prototype.queryWeather=function(){var f=this;if(this.jqxhr||!this.active){return}return this.jqxhr=$.ajax({dataType:"xml",type:"get",url:"/ajax/town-weather.php",data:{},success:function(g){f.processWeather(g);return f.jqxhr=null},error:function(g){return f.jqxhr=null}})};d.prototype.processWeather=function(k){var j,i,h,f,g;i=$(k);j=i.find('tabular time[period="0"]');h={factor:{factor:"rand"},meta:{current:1,total:1,source:this.sourceId,sourceData:k}};switch(randomInt(0,1)){case 0:g=parseFloat(j.find("windSpeed").attr("mps"));h.factor.valueModifier=randomInt(0,1)===1?g:-g;h.meta.sourceAttr="wind";h.meta.summary="Wind blowing at "+g+" mps in "+i.find("location name").text();break;case 1:f=parseFloat(j.find("temperature").attr("value"));h.factor.valueModifier=10*(f-10)/60;h.meta.sourceAttr="temperature";h.meta.summary="It's around "+f+"Â°C in "+i.find("location name").text()}EventDispatcher.trigger("audanism/influence",h);return EventDispatcher.trigger("audanism/influence/factor/done",[[h]])};return d})(Audanism.SourceAdapter.SourceAdapter);window.Audanism.SourceAdapter.WheatherSourceAdapter=a}).call(this);(function(){var a;a=(function(){function b(){}b.SCALE_MAJOR=[0,2,4,5,7,9,11];b.SCALE_MINOR=[0,2,3,5,7,9,10];b.getFreqFromNote=function(d,h){var e,i,g,c,f;if(h==null){h="minor"}d=440*Math.pow(2,(d-69)/12);if(h&&h==="minor"){d=Math.round(d);e=Math.abs(d-69)%12;f=window.Audanism.Audio.Module.Harmonizer.SCALE_MINOR;for(g=0,c=f.length;g<c;g++){i=f[g];if(d===i){break}d=d+1}}if(h&&h==="major"){console.log()}return d};b.getNoteFromFreq=function(c){return Math.round(logWithBase(2,c/440)*12+69)};return b})();window.Audanism.Audio.Module.Harmonizer=a}).call(this);(function(){var a;a=(function(){function b(f,e,d,c){this.attack=f;this.decay=e;this.sustain=d;this.release=c}b.prototype.set=function(f,e,d,c){this.attack=f;this.decay=e;this.sustain=d;this.release=c};b.prototype.getTimeUntilRelease=function(){return this.attack+this.decay};b.prototype.getEnvelopeDuration=function(){return this.attack+this.decay+this.release};return b})();window.Audanism.Audio.Module.ASDR=a}).call(this);(function(){var a;a=(function(){function b(p,j,m){var h,o,k,c,d,l,f,g,e;this.seconds=p;this.decay=j;this.reverse=m;if((g=this.reverse)==null){this.reverse=false}l=Audanism.Audio.audioContext.sampleRate;c=l*this.seconds;this.impulse=Audanism.Audio.audioContext.createBuffer(2,c,l);o=this.impulse.getChannelData(0);k=this.impulse.getChannelData(1);d;for(h=f=0,e=c-1;0<=e?f<=e:f>=e;h=0<=e?++f:--f){d=this.reverse?c-h:h;o[h]=(1-Math.random()*2)*Math.pow(1-d/c,this.decay);k[h]=(1-Math.random()*2)*Math.pow(1-d/c,this.decay)}}b.prototype.getBuffer=function(){return this.impulse};return b})();window.Audanism.Audio.Module.Impulse=a}).call(this);(function(){var a;a=(function(){function b(d,c){this["in"]=d;this.out=c;this.fxs=[];if(!(this["in"]!=null)){throw new Exception("No @in provided to FXChain.")}if(!(this.out!=null)){throw new Exception("No @out provided to FXChain.")}this.wet=Audanism.Audio.audioContext.createGain();this.wet.connect(this.out)}b.prototype.addFx=function(c){var d;this.fx=c;d=this.fxs.length;if(d===0){this["in"].connect(this.fx["in"])}else{this.fxs[d-1].out.disconnect(0);this.fxs[d-1].out.connect(this.fx["in"])}this.fx.out.connect(this.wet);return this.fxs[d]=this.fx};b.prototype.setWetAmount=function(c){return this.wet.gain.value=c};return b})();window.Audanism.Audio.FX.FXChain=a}).call(this);(function(){var a;a=(function(){function b(d,c){this["in"]=d;this.out=c}return b})();window.Audanism.Audio.FX.FX=a}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(d){b(e,d);function e(j,h,g){var i,f,k;this.seconds=j;this.decay=h;this.wetAmount=g;if((i=this.seconds)==null){this.seconds=1}if((f=this.decay)==null){this.decay=0.5}if((k=this.wetAmount)==null){this.wetAmount=1}this.impulse=new Audanism.Audio.Module.Impulse(this.seconds,this.decay);this.rev=Audanism.Audio.audioContext.createConvolver();this.rev.buffer=this.impulse.getBuffer();this.wet=Audanism.Audio.audioContext.createGain();this.wet.gain.value=g;this.rev.connect(this.wet);e.__super__.constructor.call(this,this.rev,this.wet)}return e})(Audanism.Audio.FX.FX);window.Audanism.Audio.FX.Reverb=c}).call(this);(function(){var a;a=(function(){function b(e,c,g){var d,f;this.instrumentsIn=e;this.synthesizer=c;this.autoRelease=g;if((f=this.autoRelease)==null){this.autoRelease=true}this.voices=(function(){var i,h;h=[];for(d=i=0;i<=120;d=++i){h.push(null)}return h})();this.noteTimers=(function(){var i,h;h=[];for(d=i=0;i<=120;d=++i){h.push(null)}return h})()}b.prototype.createVoice=function(c){if(this.beforeCreateVoice){this.beforeCreateVoice(c)}if(!this.voices[c]){this.voices[c]=new Audanism.Audio.Synthesizer[this.synthesizer](c);if(this.setupVoice){this.setupVoice(this.voices[c])}this.voices[c].masterVol.connect(this.instrumentsIn)}return this.voices[c]};b.prototype.killVoiceAtNote=function(c){var d=this;if(this.voices[c]){return setTimeout(function(){return d.voices[c]=null},(this.voices[c].asdr.getEnvelopeDuration()*1000)+1)}};b.prototype.noteOn=function(c,d){var f,e,g=this;if(this.noteTimers[c]){clearTimeout(this.noteTimers[c]);this.noteTimers[c]=null}e=this.createVoice(c);if(d==null){d=0}f=this.autoRelease?d:-1;e.noteOn(f);if(this.autoRelease){this.noteTimers[c]=setTimeout(function(){g.voices[c].stop();g.voices[c].masterVol.disconnect(0);g.voices[c]=null;clearTimeout(g.noteTimers[c]);g.noteTimers[c]=null;if(g.onNoteOff){return g.onNoteOff(c)}},(e.asdr.getEnvelopeDuration()*1000)+10)}if(this.onNoteOn){return this.onNoteOn(c,d)}};b.prototype.notesOff=function(){var e,h,g,d,f,c,i=this;f=this.voices;c=[];for(g=0,d=f.length;g<d;g++){h=f[g];if(!h){continue}e=h.note;h.noteOff();c.push(setTimeout(function(){i.voices[e]=null;clearTimeout(i.noteTimers[e]);i.noteTimers[e]=null;if(i.onNoteOff){return i.onNoteOff(e)}},h.asdr.release+1))}return c};return b})();window.Audanism.Audio.Instrument.Instrument=a}).call(this);(function(){var b,a={}.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};b=(function(e){c(d,e);function d(f){this.instrumentsIn=f;d.__super__.constructor.call(this,this.instrumentsIn,"MonoistEnv",true)}d.prototype.setupVoice=function(f){f.masterVol.gain.value=0.1;return f.pan.setPosition(1-Math.random()*2,0,1-Math.random()*2)};return d})(Audanism.Audio.Instrument.Instrument);window.Audanism.Audio.Instrument.TestInstrument=b}).call(this);(function(){var b,a={}.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};b=(function(e){c(d,e);function d(h,f){var g;this.instrumentsIn=h;this.unison=f!=null?f:true;d.__super__.constructor.call(this,this.instrumentsIn,"MonoistEnvModWide",false);this.autoPans=(function(){var k,j,i;i=[];for(g=k=0,j=this.voices.length-1;0<=j?k<=j:k>=j;g=0<=j?++k:--k){i.push(null)}return i}).call(this);this.vibrates=(function(){var k,j,i;i=[];for(g=k=0,j=this.voices.length-1;0<=j?k<=j:k>=j;g=0<=j?++k:--k){i.push(null)}return i}).call(this);this.droneNote=0}d.prototype.setNote=function(l){var o,m,j,i,n,f,k,h,g;this.droneNote=l;k=this.voices;g=[];for(j=0,n=k.length;j<n;j++){m=k[j];if(m){h=m.oscillators;for(i=0,f=h.length;i<f;i++){o=h[i];o.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(l)}g.push(m.setUnison(this.unison))}else{g.push(void 0)}}return g};d.prototype.setUnison=function(h){var k,j,g,i,f;this.unison=h;i=this.voices;f=[];for(j=0,g=i.length;j<g;j++){k=i[j];if(k){f.push(k.setUnison(this.unison))}else{f.push(void 0)}}return f};d.prototype.onNoteOn=function(f){var h,g=this;this.setUnison(this.unison);h={note:f,frame:-1,interval:null,speed:0.1+Math.random()*1.3,maxGain:this.voices[f].masterVol.gain.value};this.voices[f].masterVol.gain.value=0;h.interval=setInterval(function(){var j;try{h.frame++;j=(1+Math.sin((h.speed/2)*(h.frame/10)-Math.PI/2))/2;return g.voices[f].masterVol.gain.value=h.maxGain*j}catch(i){}},100);return this.vibrates[f]=h};d.prototype.onNoteOff=function(f){if(this.autoPans[f]){clearInterval(this.autoPans[f].interval);this.autoPans[f]=null}if(this.vibrates[f]){clearInterval(this.vibrates[f].interval);return this.vibrates[f]=null}};d.prototype.kill=function(){var j,i,g,h,f;h=this.vibrates;f=[];for(i=0,g=h.length;i<g;i++){j=h[i];if(!j){continue}if(j.interval){f.push(clearInterval(j.interval))}else{f.push(void 0)}}return f};return d})(Audanism.Audio.Instrument.Instrument);window.Audanism.Audio.Instrument.Drone=b}).call(this);(function(){var b,a={}.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};b=(function(e){c(d,e);function d(f){this.instrumentsIn=f;d.__super__.constructor.call(this,this.instrumentsIn,"MonoistEnvMod")}d.prototype.setupVoice=function(f){return f.pan.setPosition(1-Math.random()*2,0,1-Math.random()*2)};d.prototype.playChord=function(k){var i,h,j,g,f;h=[k-12,k,k+7,k+10,k+15];f=[];for(j=0,g=h.length;j<g;j++){i=h[j];f.push(this.noteOn(i))}return f};return d})(Audanism.Audio.Instrument.Instrument);window.Audanism.Audio.Instrument.Pad=b}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(d){b(e,d);function e(h,j,g){var i,f;this.instrumentsIn=h;this.frequency=j;this.shuffleAmount=g;e.__super__.constructor.call(this,this.instrumentsIn,"MonoistPerc",true);if((i=this.frequency)==null){this.frequency=1}if((f=this.shuffleAmount)==null){this.shuffleAmount=0.333}this.fixedShuffle=false;this.intervalTime=1/this.frequency;this.midNote=80;this.noteSpread=60;this.interval=null;this.count=0;this.isRunning=false;this.shouldRestart=false;this.hpfVal=0;this.lpfVal=20000}e.prototype.setFrequency=function(f){this.frequency=f;this.intervalTime=1/this.frequency;return this.shouldRestart=true};e.prototype.beforeCreateVoice=function(f){if(this.voices[f]){return this.voices[f]=null}};e.prototype.setupVoice=function(f){f.pan.setPosition(1-Math.random()*2,0,1-Math.random()*2);f.waitTime=this.count%2===0||(!this.fixedShuffle&&randomInt(0,1)===0)?this.shuffleAmount*this.intervalTime:0;f.hpf.frequency.value=this.hpfVal;f.lpf.frequency.value=this.lpfVal;f.modGain2.gain.value=0.5*(1+Math.sin(this.count/(this.intervalTime*100)-Math.PI/2))*f.modGain2.gain.value;return f.masterVol.gain.value=0.3};e.prototype.start=function(){var f=this;this.isRunning=true;if(this.interval){this.stop()}return this.interval=setInterval(function(){f.count++;return f.hit()},this.intervalTime*1000)};e.prototype.stop=function(){this.isRunning=false;clearInterval(this.interval);return this.interval=null};e.prototype.hit=function(){if(this.shouldRestart){this.stop();this.start();this.shouldRestart=false}else{this.noteOn(this.midNote-randomInt(0,this.noteSpread))}return this.count++};e.prototype.onNoteOn=function(f){return this.count++};e.prototype.onNoteOff=function(f){};return e})(Audanism.Audio.Instrument.Instrument);window.Audanism.Audio.Instrument.PercArpeggiator=c}).call(this);(function(){var b,a={}.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};b=(function(e){c(d,e);function d(f){this.instrumentsIn=f;d.__super__.constructor.call(this,this.instrumentsIn,null,false);this.createNoise()}d.prototype.createNoise=function(){var g,f;g=4096;f=function(){p;o;n;m;l;k;j;var p,o,n,m,l,k,j,h,i=this;p=o=n=m=l=k=j=0;h=Audanism.Audio.audioContext.createScriptProcessor(g,1,1);h.onaudioprocess=function(w){var t,s,r,v,u,q;s=w.outputBuffer.getChannelData(0);q=[];for(t=v=0,u=g-1;0<=u?v<=u:v>=u;t=0<=u?++v:--v){r=Math.random()*2-1;p=0.99886*p+r*0.0555179;o=0.99332*o+r*0.0750759;n=0.969*n+r*0.153852;m=0.8665*m+r*0.3104856;l=0.55*l+r*0.5329522;k=-0.7616*k-r*0.016898;s[t]=p+o+n+m+l+k+j+r*0.5362;s[t]*=0.11;q.push(j=r*0.115926)}return q};return h};this.noiseVol=Audanism.Audio.audioContext.createGain();this.noiseVol.gain.value=0.1;this.noiseLpf=Audanism.Audio.audioContext.createBiquadFilter();this.noiseLpf.type="lowpass";this.noiseLpf.frequency.value=10000;this.noise=f();this.noise.connect(this.noiseLpf);this.noiseLpf.connect(this.noiseVol);return this.noiseVol.connect(this.instrumentsIn)};d.prototype.start=function(){return this.noiseVol.gain.value=0.1};d.prototype.stop=function(){return this.noiseVol.gain.value=0};d.prototype.setLpfFrequency=function(f){return this.noiseLpf.frequency.value=f};return d})(Audanism.Audio.Instrument.Instrument);window.Audanism.Audio.Instrument.NoisePink=b}).call(this);(function(){var a;a=(function(){function b(d,e,c){this.note=d;this.fxIn=e;this.masterWet=c;this.oscillators=[];this.envelopes=[];this.waitTime=0;this.pan=Audanism.Audio.audioContext.createPanner();this.masterVol=Audanism.Audio.audioContext.createGain();this.masterVol.gain.value=0.0005;this.pan.connect(this.masterVol)}b.prototype.noteOn=function(d){var o,e,l,k,j,c,m,n,g,h,f;k=d>this.asdr.attack+this.asdr.decay?d-this.asdr.attack-this.asdr.decay:0;c=Audanism.Audio.audioContext.currentTime+this.waitTime;o=c+this.asdr.attack;e=o+this.asdr.decay;n=d>=0?e+k:0;m=n+this.asdr.release;f=[];for(j=g=0,h=this.envelopes.length-1;0<=h?g<=h:g>=h;j=0<=h?++g:--g){l=this.envelopes[j];l.gain.cancelScheduledValues(c);l.gain.setValueAtTime(l.gain.value,c);l.gain.linearRampToValueAtTime(1,o);l.gain.linearRampToValueAtTime(this.asdr.sustain,e);if(k>0){l.gain.linearRampToValueAtTime(this.asdr.sustain,n)}if(d>=0){f.push(l.gain.linearRampToValueAtTime(0,m))}else{f.push(void 0)}}return f};b.prototype.noteOff=function(){var h,g,d,f,k,j,c;d=Audanism.Audio.audioContext.currentTime;f=d+this.asdr.release;c=[];for(g=k=0,j=this.envelopes.length-1;0<=j?k<=j:k>=j;g=0<=j?++k:--k){h=this.envelopes[g];h.gain.cancelScheduledValues(d);h.gain.setValueAtTime(h.gain.value,d);h.gain.linearRampToValueAtTime(0,f);try{c.push(this.oscillators[g].stop(f+0.01))}catch(l){}}return c};b.prototype.stop=function(h){var e,g,d,f,c;if(h==null){h=0}f=this.oscillators;c=[];for(g=0,d=f.length;g<d;g++){e=f[g];c.push(e.stop(h))}return c};b.prototype.setPan=function(c){return this.pan.setPosition(c,0,0)};b.prototype.getRandomOscType=function(){var c;c=["sine","sawtooth","square","triangle"];return c[randomInt(0,3)]};return b})();window.Audanism.Audio.Synthesizer.Voice=a}).call(this);(function(){var a;a=(function(){function b(c){this.note=c;this.effectChain=Audanism.Audio.audioContext.createGain();this.volNode=Audanism.Audio.audioContext.createGain();this.volNode.gain.value=0.25;this.effectChain.connect(this.volNode);this.volNode.connect(Audanism.Audio.audioContext.destination);this.freq=Audanism.Audio.Harmonizer.getFreqFromNote(this.note);this.osc=Audanism.Audio.audioContext.createOscillator();this.osc.frequency.setValueAtTime(this.freq,0);this.osc.connect(this.effectChain);this.osc.start(0)}b.prototype.noteOn=function(c){return this.osc.frequency.setValueAtTime(Audanism.Audio.Harmonizer.getFreqFromNote(c),0)};b.prototype.noteOff=function(){return this.osc.stop(Audanism.Audio.audioContext.currentTime+0.1)};return b})();window.Audanism.Audio.Synthesizer.Monoist=a}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(e){b(d,e);function d(f){d.__super__.constructor.call(this,f);this.asdr=new Audanism.Audio.Module.ASDR(0.2,0.1,0.7,0.2);this.envelope=Audanism.Audio.audioContext.createGain();this.envelope.gain.setValueAtTime(0,0);this.envelopes.push(this.envelope);this.osc=Audanism.Audio.audioContext.createOscillator();this.osc.type="sine";this.osc.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note);this.oscillators.push(this.osc);this.osc.connect(this.envelope);this.envelope.connect(this.pan);this.osc.start(0)}return d})(Audanism.Audio.Synthesizer.Voice);window.Audanism.Audio.Synthesizer.MonoistEnv=c}).call(this);(function(){var a,b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};a=(function(e){c(d,e);function d(f){d.__super__.constructor.call(this,f);this.asdr=new Audanism.Audio.Module.ASDR(0.03,0.01,100,1.5);this.envelope1=Audanism.Audio.audioContext.createGain();this.envelope1.gain.setValueAtTime(0,0);this.envelope1.connect(this.pan);this.envelopes.push(this.envelope1);this.osc1=Audanism.Audio.audioContext.createOscillator();this.osc1.type=this.getRandomOscType();this.osc1.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note);this.osc1.connect(this.envelope1);this.oscillators.push(this.osc1);this.freqModGain1=Audanism.Audio.audioContext.createGain();this.freqModGain1.gain.value=5;this.freqModGain1.connect(this.osc1.frequency);this.freqMod1=Audanism.Audio.audioContext.createOscillator();this.freqMod1.type=this.getRandomOscType();this.freqMod1.frequency.value=20;this.freqMod1.connect(this.freqModGain1);this.freqMod1.start(0);this.freqModGain2=Audanism.Audio.audioContext.createGain();this.freqModGain2.gain.value=7;this.freqModGain2.connect(this.osc1.frequency);this.freqMod2=Audanism.Audio.audioContext.createOscillator();this.freqMod2.type=this.getRandomOscType();this.freqMod2.frequency.value=6.234;this.freqMod2.connect(this.freqModGain2);this.freqMod2.start(0);this.osc1.start(0)}return d})(Audanism.Audio.Synthesizer.Voice);window.Audanism.Audio.Synthesizer.MonoistEnvMod=a}).call(this);(function(){var a,b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};a=(function(e){c(d,e);function d(g,f){this.unison=f!=null?f:true;d.__super__.constructor.call(this,g);this.extraNotes=[19,27,13];this.extraNotes.shuffle();this.asdr=new Audanism.Audio.Module.ASDR(0.03,0.1,100,0.1);this.envelope=Audanism.Audio.audioContext.createGain();this.envelope.gain.value=0;this.envelope.connect(this.pan);this.envelopes.push(this.envelope);this.pan1=Audanism.Audio.audioContext.createPanner();this.pan1.setPosition(-1,0,0);this.pan1.connect(this.envelope);this.pan2=Audanism.Audio.audioContext.createPanner();this.pan2.setPosition(1,0,0);this.pan2.connect(this.envelope);this.pan3=Audanism.Audio.audioContext.createPanner();this.pan3.setPosition(0,0,0);this.pan3.connect(this.envelope);this.osc1=Audanism.Audio.audioContext.createOscillator();this.osc1.type=this.getRandomOscType();this.osc1.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note+(this.unison?0:this.extraNotes[0]));this.osc1.connect(this.pan1);this.osc2=Audanism.Audio.audioContext.createOscillator();this.osc2.type=this.getRandomOscType();this.osc2.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note+(this.unison?0:this.extraNotes[1]));this.osc2.connect(this.pan2);this.osc3=Audanism.Audio.audioContext.createOscillator();this.osc3.type=this.getRandomOscType();this.osc3.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note+(this.unison?0:this.extraNotes[2]));this.osc3.connect(this.pan2);this.oscillators.push(this.osc1);this.oscillators.push(this.osc2);this.oscillators.push(this.osc3);this.freqModGain1=Audanism.Audio.audioContext.createGain();this.freqModGain1.gain.value=5;this.freqModGain1.connect(this.osc1.frequency);this.freqMod1=Audanism.Audio.audioContext.createOscillator();this.freqMod1.type=this.getRandomOscType();this.freqMod1.frequency.value=8;this.freqMod1.connect(this.freqModGain1);this.freqMod1.start(0);this.freqModGain2=Audanism.Audio.audioContext.createGain();this.freqModGain2.gain.value=5;this.freqModGain2.connect(this.osc2.frequency);this.freqMod2=Audanism.Audio.audioContext.createOscillator();this.freqMod2.type=this.getRandomOscType();this.freqMod2.frequency.value=13.123;this.freqMod2.connect(this.freqModGain2);this.freqMod2.start(0);this.freqModGain3=Audanism.Audio.audioContext.createGain();this.freqModGain3.gain.value=15;this.freqModGain3.connect(this.osc3.frequency);this.freqMod3=Audanism.Audio.audioContext.createOscillator();this.freqMod3.type=this.getRandomOscType();this.freqMod3.frequency.value=0.123;this.freqMod3.connect(this.freqModGain3);this.freqMod3.start(0);this.osc1.start(0);this.osc2.start(0);this.osc3.start(0)}d.prototype.setUnison=function(g){var h,j,l,k,f;this.unison=g;f=[];for(j=l=0,k=this.oscillators.length-1;0<=k?l<=k:l>=k;j=0<=k?++l:--l){h=this.unison?0:this.extraNotes[j];f.push(this.oscillators[j].frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note+h))}return f};return d})(Audanism.Audio.Synthesizer.Voice);window.Audanism.Audio.Synthesizer.MonoistEnvModWide=a}).call(this);(function(){var a;a=(function(){function b(){this.note=randomInt(40,80);this.noteIsOn=false;this.volNode=Audanism.Audio.audioContext.createGain();this.volNode.gain.value=0.25;this.volNode.connect(Audanism.Audio.audioContext.destination);this.compressor=Audanism.Audio.audioContext.createDynamicsCompressor();this.compressor.connect(this.volNode);this.dry=Audanism.Audio.audioContext.createGain();this.dry.gain.value=0.8;this.dry.connect(this.compressor);this.wet=Audanism.Audio.audioContext.createGain();this.wet.gain.value=0.5;this.wet.connect(this.compressor);this.impulse=new Audanism.Audio.Module.Impulse(0.2,50);this.rev1=Audanism.Audio.audioContext.createConvolver();this.rev1.buffer=this.impulse.getBuffer();this.rev1.connect(this.wet);this.panner1=Audanism.Audio.audioContext.createPanner();this.panner1.setPosition(1-Math.random()*2,0,0);this.panner1.connect(this.dry);this.panner1.connect(this.rev1);this.asdr=new Audanism.Audio.Module.ASDR(0.5,0.1,10,0.1);this.envelope=Audanism.Audio.audioContext.createGain();this.envelope.gain.setValueAtTime(0,0);this.envelope.connect(this.panner1);this.osc=Audanism.Audio.audioContext.createOscillator();this.osc.frequency.value=Audanism.Audio.Harmonizer.getFreqFromNote(this.note);this.osc.connect(this.envelope);this.osc.start(0)}b.prototype.noteOn=function(e){var c,d;d=Audanism.Audio.audioContext.currentTime;c=d+this.asdr.attack;this.envelope.gain.cancelScheduledValues(d);this.envelope.gain.setValueAtTime(this.envelope.gain.value,d);this.envelope.gain.linearRampToValueAtTime(1,c);this.envelope.gain.setTargetAtTime(this.asdr.sustain/100,c,(this.asdr.decay/100)+0.001);return this.noteIsOn=true};b.prototype.noteOff=function(){var d,c;d=Audanism.Audio.audioContext.currentTime;c=d+this.asdr.release;console.log(d);this.envelope.gain.cancelScheduledValues(d);this.envelope.gain.setValueAtTime(this.envelope.gain.value,d);this.envelope.gain.linearRampToValueAtTime(0,c);return this.noteIsOn=false};return b})();window.Audanism.Audio.Synthesizer.MonoistEnvRev=a}).call(this);(function(){var a;a=(function(){function b(){this.note=randomInt(40,80);this.noteIsOn=false;this.volNode=Audanism.Audio.audioContext.createGain();this.volNode.gain.value=0.25;this.volNode.connect(Audanism.Audio.audioContext.destination);this.compressor=Audanism.Audio.audioContext.createDynamicsCompressor();this.compressor.connect(this.volNode);this.panner1=Audanism.Audio.audioContext.createPanner();this.panner1.setPosition(-1,0,0);this.panner1.connect(this.compressor);this.panner2=Audanism.Audio.audioContext.createPanner();this.panner2.setPosition(1,0,0);this.panner2.connect(this.compressor);this.panner3=Audanism.Audio.audioContext.createPanner();this.panner3.setPosition(0,0,0);this.panner3.connect(this.compressor);this.asdr=new Audanism.Audio.Module.ASDR(0.1,0.1,100,0.1);this.envelope1=Audanism.Audio.audioContext.createGain();this.envelope1.gain.setValueAtTime(0,0);this.envelope1.connect(this.panner1);this.envelope2=Audanism.Audio.audioContext.createGain();this.envelope2.gain.setValueAtTime(0,0);this.envelope2.connect(this.panner2);this.envelope3=Audanism.Audio.audioContext.createGain();this.envelope3.gain.setValueAtTime(0,0);this.envelope3.connect(this.panner3);this.osc1=Audanism.Audio.audioContext.createOscillator();this.osc1.type="sine";this.osc1.frequency.value=Audanism.Audio.Harmonizer.getFreqFromNote(this.note);this.osc1.connect(this.envelope1);this.osc1.start(0);this.osc2=Audanism.Audio.audioContext.createOscillator();this.osc2.type="triangle";this.osc2.frequency.value=Audanism.Audio.Harmonizer.getFreqFromNote(this.note*1);this.osc2.connect(this.envelope2);this.osc2.start(0)}b.prototype.noteOn=function(e){var c,d;d=Audanism.Audio.audioContext.currentTime;c=d+this.asdr.attack;this.envelope1.gain.cancelScheduledValues(d);this.envelope1.gain.setValueAtTime(this.envelope1.gain.value,d);this.envelope1.gain.linearRampToValueAtTime(1,c);this.envelope2.gain.cancelScheduledValues(d);this.envelope2.gain.setValueAtTime(this.envelope1.gain.value,d);this.envelope2.gain.linearRampToValueAtTime(1,c);this.envelope3.gain.cancelScheduledValues(d);this.envelope3.gain.setValueAtTime(this.envelope1.gain.value,d);this.envelope3.gain.linearRampToValueAtTime(1,c);this.envelope1.gain.setTargetAtTime(this.asdr.sustain/100,c,(this.asdr.decay/100)+0.001);this.envelope2.gain.setTargetAtTime(this.asdr.sustain/100,c,(this.asdr.decay/100)+0.001);this.envelope3.gain.setTargetAtTime(this.asdr.sustain/100,c,(this.asdr.decay/100)+0.001);return this.noteIsOn=true};b.prototype.noteOff=function(){var d,c;d=Audanism.Audio.audioContext.currentTime;c=d+this.asdr.release;console.log(d);this.envelope1.gain.cancelScheduledValues(d);this.envelope1.gain.setValueAtTime(this.envelope1.gain.value,d);this.envelope1.gain.linearRampToValueAtTime(0,c);this.envelope2.gain.cancelScheduledValues(d);this.envelope2.gain.setValueAtTime(this.envelope2.gain.value,d);this.envelope2.gain.linearRampToValueAtTime(0,c);this.envelope3.gain.cancelScheduledValues(d);this.envelope3.gain.setValueAtTime(this.envelope3.gain.value,d);this.envelope3.gain.linearRampToValueAtTime(0,c);return this.noteIsOn=false};return b})();window.Audanism.Audio.Synthesizer.MonoistEnvMulti=a}).call(this);(function(){var c,a={}.hasOwnProperty,b=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};c=(function(d){b(e,d);function e(f){e.__super__.constructor.call(this,f);this.delay=Audanism.Audio.audioContext.createDelay();this.delay.delayTime=4;this.delay.connect(this.pan);this.lpf=Audanism.Audio.audioContext.createBiquadFilter();this.lpf.type="lowpass";this.lpf.frequency.value=20000;this.hpf=Audanism.Audio.audioContext.createBiquadFilter();this.hpf.type="highpass";this.hpf.frequency.value=0;this.hpf.connect(this.lpf);this.lpf.connect(this.delay);this.asdr=new Audanism.Audio.Module.ASDR(0.01,0,1,0.2);this.envelope=Audanism.Audio.audioContext.createGain();this.envelope.gain.setValueAtTime(0,0);this.envelope.connect(this.hpf);this.envelopes.push(this.envelope);this.osc=Audanism.Audio.audioContext.createOscillator();this.osc.frequency.value=Audanism.Audio.Module.Harmonizer.getFreqFromNote(this.note);this.osc.connect(this.envelope);this.osc.start(0);this.oscillators.push(this.osc);this.mod=Audanism.Audio.audioContext.createOscillator();this.mod.type=this.getRandomOscType();this.mod.frequency=randomInt(10,20);this.mod.start(0);this.modGain=Audanism.Audio.audioContext.createGain();this.modGain.gain.value=20;this.mod.connect(this.modGain);this.modGain.connect(this.osc.frequency);this.mod2=Audanism.Audio.audioContext.createOscillator();this.mod2.type="sawtooth";this.mod2.frequency=randomInt(500,1000);this.mod2.start(0);this.modGain2=Audanism.Audio.audioContext.createGain();this.modGain2.gain.value=100;this.mod2.connect(this.modGain2);this.modGain2.connect(this.osc.frequency)}e.prototype.noteOn=function(){var g,f,h,i;h=Audanism.Audio.audioContext.currentTime+this.waitTime;g=h+this.asdr.attack;f=g+this.asdr.decay;i=g+this.asdr.release;this.envelope.gain.cancelScheduledValues(h);this.envelope.gain.setValueAtTime(0,h);this.envelope.gain.linearRampToValueAtTime(1,g);return this.envelope.gain.linearRampToValueAtTime(0,i)};return e})(Audanism.Audio.Synthesizer.Voice);window.Audanism.Audio.Synthesizer.MonoistPerc=c}).call(this);(function(){var a;a=(function(){function b(){var f,c;try{f=window.AudioContext||window.webkitAudioContext;Audanism.Audio.audioContext=new f}catch(d){alert("Sorry, your browser does not support AudioContext, try Chrome!")}this.isMuted=false;this.createEndChain();this.noise=new Audanism.Audio.Instrument.NoisePink(this.instrumentsIn);this.noise.setLpfFrequency(1000);this.factorDrones=(function(){var h,g,e;e=[];for(c=h=0,g=Audanism.Environment.Organism.NUM_FACTORS-1;0<=g?h<=g:h>=g;c=0<=g?++h:--h){e.push(new Audanism.Audio.Instrument.Drone(this.instrumentsIn))}return e}).call(this);this.compareInstr=new Audanism.Audio.Instrument.TestInstrument(this.instrumentsIn);this.influencePad=new Audanism.Audio.Instrument.Pad(this.instrumentsIn);this.arpeggiator=new Audanism.Audio.Instrument.PercArpeggiator(this.instrumentsIn,4,0);EventDispatcher.listen("audanism/controls/togglesound",this,this.toggleMute);EventDispatcher.listen("audanism/iteration",this,this.updateSounds);EventDispatcher.listen("audanism/influence/node",this,this.handleNodeInfluence);EventDispatcher.listen("audanism/alter/nodes",this,this.handleNodeComparison);EventDispatcher.listen("audanism/performance/bad",this,this.onPermanceBad);EventDispatcher.listen("audanism/organism/stressmode",this,this.onStressModeChange)}b.prototype.createEndChain=function(){this["void"]=Audanism.Audio.audioContext.createOscillator();this["void"].frequency.value=440;this.voidGain=Audanism.Audio.audioContext.createGain();this.voidGain.gain.value=0;this.instrumentsIn=Audanism.Audio.audioContext.createGain();this.instrumentsIn.gain.value=0.2;this.masterRev=new Audanism.Audio.FX.Reverb(2,50,1);this.compressor=Audanism.Audio.audioContext.createDynamicsCompressor();this.compressor.threshold.value=-24;this.compressor.ratio.value=6;this.analyser=Audanism.Audio.audioContext.createAnalyser();this.analyser.fftSize=512;this["void"].connect(this.voidGain);this.voidGain.connect(this.instrumentsIn);this["void"].start(0);this.instrumentsIn.connect(this.masterRev["in"]);this.masterRev.out.connect(this.compressor);this.instrumentsIn.connect(this.compressor);this.compressor.connect(this.analyser);return this.analyser.connect(Audanism.Audio.audioContext.destination)};b.prototype.getFrequencyData=function(){var c;c=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(c);return c};b.prototype.setOrganism=function(c){this.organism=c};b.prototype.mute=function(){var j,i,g,f,e,h,c,d;console.log("Conductor #mute()");this.isMuted=true;this.arpeggiator.stop();h=this.factorDrones;for(i=0,f=h.length;i<f;i++){j=h[i];j.notesOff()}c=this.factorDrones;d=[];for(g=0,e=c.length;g<e;g++){j=c[g];d.push(j.kill())}return d};b.prototype.unmute=function(){var g,f,d,e,c;console.log("Conductor #unmute()");this.isMuted=false;this.arpeggiator.start();e=this.factorDrones;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(g.noteOn(g.droneNote))}return c};b.prototype.toggleMute=function(){console.log("Conductor #toggleMute");if(this.isMuted){this.unmute()}else{this.mute()}return console.log("... now muted:",this.isMuted)};b.prototype.updateSounds=function(n){var e,d,k,g,c,l,f,j,h,m,i;if(this.isMuted){return}l=this.organism.getFactors();f=0;i=this.factorDrones;for(h=0,m=i.length;h<m;h++){c=i[h];j=Audanism.Audio.Module.Harmonizer.getNoteFromFreq(l[f].disharmony/10);if(n.count===1){c.noteOn(j)}else{c.setNote(j)}f++}if(n.count%10===!0){return}e=this.organism.getDisharmonyHistoryData(200);d=e[e.length-1][2];k=e[0][2];g=d/k;if(this.noise!=null){this.noise.setLpfFrequency(g*1000)}if(n.count%4===1){this.arpeggiator.midNote+=g>1?1:-1}if(n.count%9===1&&e.length>1){this.arpeggiator.shuffleAmount=0.01*(Math.round(d)%100)}if(n.count%10===1){return this.arpeggiator.setFrequency(Math.max(6,g))}};b.prototype.handleNodeComparison=function(k){var j,d,f,e,h,g,c;if(this.isMuted){return}c=[];for(d=h=0,g=k.nodes.length-1;0<=g?h<=g:h>=g;d=0<=g?++h:--h){f=k.nodes[d];j=90+Math.pow(f.getCell(k.factorType).factorValue,1.3);e=Audanism.Audio.Module.Harmonizer.getNoteFromFreq(j);c.push(this.compareInstr.noteOn(e))}return c};b.prototype.handleNodeInfluence=function(d){var c,f,e;if(this.isMuted){return}if(!this.organism||!d.meta){return}f=d.node.node.nodeId;c=80+(f*40);e=f/this.organism.getNodes().length;return this.influencePad.noteOn(Audanism.Audio.Module.Harmonizer.getNoteFromFreq(c))};b.prototype.onStressModeChange=function(e){var h,g,d,f,c;f=this.factorDrones;c=[];for(g=0,d=f.length;g<d;g++){h=f[g];c.push(h.setUnison(!e))}return c};b.prototype.onPermanceBad=function(){var c,d=this;if(this.isMuted){return}this.mute();c=this.arpeggiator.frequency;this.arpeggiator.setFrequency(0.2);return setTimeout(function(){d.unmute();return d.arpeggiator.setFrequency(c)},10000)};return b})();window.Audanism.Audio.Conductor=a}).call(this);(function(){var b,a=function(c,d){return function(){return c.apply(d,arguments)}};b=(function(){function c(){this._setWikiContent=a(this._setWikiContent,this);this.$organismStats=$("#organism-stats");this.$factorStats=$("#factor-stats");this.$influences=$("#influences");this.$influenceTemplate=this.$influences.find(".template").clone(true).removeClass("template");this.$influences.find(".template").hide();this.$wiki=$("#wiki");this._setupControls();this._setupWiki();this._showCozyInfo();EventDispatcher.listen("audanism/iteration",this,this.onIteration);EventDispatcher.listen("audanism/influence/node/done",this,this.onInfluenceNodeDone);EventDispatcher.listen("audanism/influence/factor/after",this,this.onInfluenceFactorAfter);EventDispatcher.listen("audanism/organism/stressmode",this,this.onStressModeChange)}c.prototype._setupControls=function(){var d=this;$("#controls .btn").click(function(f){f.preventDefault();return EventDispatcher.trigger("audanism/controls/"+$(f.currentTarget).attr("href").replace("#",""))});EventDispatcher.listen("audanism/controls/start",this,function(){return $("body").removeClass("paused").addClass("running")});EventDispatcher.listen("audanism/controls/pause audanism/controls/stop",this,function(){return $("body").removeClass("running").addClass("paused")});EventDispatcher.listen("audanism/controls/toggleview",this,function(){return $("body").toggleClass("clean-view")});return EventDispatcher.listen("audanism/controls/togglesound",this,function(){return $("body").toggleClass("muted")})};c.prototype._setupWiki=function(){var d=this;$("#wiki").fadeTo(2000,1);$(document).on("click","#intro-btn-start",function(f){f.preventDefault();EventDispatcher.trigger("audanism/controls/start");return d.$wiki.fadeOut(500,function(){return $("#intro-btn-start").html("Resume")})});$(document).on("click","[data-target-tab]",function(f){f.preventDefault();return d._setWikiContent($(f.currentTarget).attr("data-target-tab"))});return $(document).on("click","[data-toggle-wiki]",function(g){var f;g.preventDefault();f=$(g.currentTarget).attr("data-toggle-wiki");if(f==="show"){return d.$wiki.fadeIn(500)}else{return d.$wiki.fadeOut(500)}})};c.prototype._setWikiContent=function(d){if(!this.$wiki.is(":visible")){this.$wiki.fadeIn(500)}$(".tab-content").removeClass("active").filter("[data-tab='"+d+"']").addClass("active");return this.$wiki.find("a[data-target-tab]").removeClass("active").filter("[data-target-tab='"+d+"']").addClass("active")};c.prototype._showCozyInfo=function(){var d,e;d=new Date().getHours();e="";switch(d){case 23:case 0:case 1:case 2:case 3:case 4:case 5:e="night";break;case 5:case 6:case 7:e="early-morning";break;case 8:case 9:case 10:e="morning";break;case 11:case 12:case 13:e="midday";break;case 14:case 15:case 16:case 17:e="afternoon";break;case 18:case 19:case 20:case 21:case 22:e="evening"}return $(".time-of-day").filter("."+e).show()};c.prototype.onIteration=function(m){var d,j,g,k,i,f,l,h,e;i=m.organism;g=i.getDisharmonyHistoryData(1);this.$organismStats.find("#summed-disharmony .value").html(Math.round(i._sumDisharmony)).end().find("#actual-disharmony .value").html(Math.round(i._actualDisharmony)).end();j=this.$factorStats.find("#factor-values");d=this.$factorStats.find("#factor-disharmonies");h=i.getFactors();e=[];for(f=0,l=h.length;f<l;f++){k=h[f];j.find('[data-factor="'+k.factorType+'"]').html(decimalAdjust("round",k.factorValue,-1));e.push(d.find('[data-factor="'+k.factorType+'"]').html(numberSuffixed(k.disharmony,-1)))}return e};c.prototype.onInfluenceNodeDone=function(d){f;var f,g,e;g=d[0];if(g.meta.source==="instagram"){e=g.meta.sourceData;f={source:g.meta.source,summary:'<img src="'+e.images.thumbnail.url+'" /><span class="caption">'+e.caption.text.substring(0,30)+"</span>",url:e.link,type:"Nodes",value:null}}if(f){return this.appendInfluenceBox(f)}};c.prototype.onInfluenceFactorAfter=function(e){d;var d;if(e.meta.source==="weather"){d={source:e.meta.source,summary:e.meta.summary,type:"Factor "+e.factor.factor.factorType}}if(d){return this.appendInfluenceBox(d)}};c.prototype.appendInfluenceBox=function(f){var g,d,e;g=this.$influenceTemplate.clone().attr("data-influence-source",f.source);g.find(".influence-source").html(f.source);g.find(".influence-summary").html(f.summary);g.find(".influence-link").html($("<a />",{href:f.url,target:"_blank"}).html("Link"));g.find(".influence-type").html(f.type);g.find(".influence-value").html(f.value||"");this.$influences.append(g);g.show();d=this.$influences.find(".influence");e=d.size();if(e>6){return this.$influences.find(".influence").filter(function(){return d.index(this)<e-6}).hide()}};c.prototype.onStressModeChange=function(d){return this.$organismStats.find(".stress-mode-indicator").toggleClass("stressed",d)};return c})();window.Audanism.GUI.GUI=b}).call(this);(function(){var a;a=(function(){function b(){var c=this;c=this;this.opts={cameraDistanceStart:1600,cameraDistance:1300,clusterSize:1000,roomSize:3000,roomVertices:100,roomColor:new THREE.Color(4877706),roomColor2:new THREE.Color(4025725),roomColorChaos:new THREE.Color(9705808),fogColorStart:new THREE.Color(10066329),ballSize:10,ballColor:new THREE.Color(15920464),ballColorCompare:new THREE.Color(15878400),ballCompareTime:1000,ballColorInfluence:new THREE.Color(15545504),ballInfluenceTime:2000,ballColorVeteran:new THREE.Color(2045664),groupCubesEvery:6,cubesPerGroup:4};this.state={};this.queue=[];this.tweens=[];this.cubes=[];this.newCubes=[];this.cubeLines=[];this.megaCubes=[];this.cubesGrouped=0;this.newBalls=[];$(window).on("resize",this.onWindowResize.bind(this));EventDispatcher.listen("audanism/controls/start",this,this.onStart);EventDispatcher.listen("audanism/init/organism",this,this.onInitOrganism);EventDispatcher.listen("audanism/iteration",this,this.onIteration);EventDispatcher.listen("audanism/compare/nodes",this,this.onCompareNodes);EventDispatcher.listen("audanism/influence/node",this,this.onInfluenceNode);EventDispatcher.listen("audanism/influence/factor/after",this,this.onInfluenceFactorAfter);EventDispatcher.listen("audanism/node/add",this,function(d){return c.createBalls(d.numNodes)})}b.prototype.onStart=function(){if(this.balls.length===0){return this.createBalls(this.numBalls)}};b.prototype.onInitOrganism=function(c){this.organism=c;return this.init()};b.prototype.onWindowResize=function(c){this.camera.aspect=window.innerWidth/window.innerHeight;this.camera.updateProjectionMatrix();return this.renderer.setSize(window.innerWidth,window.innerHeight)};b.prototype.init=function(){window.Audanism.Graphic["public"]={animate:this.animate.bind(this)};this.buildScene();return this.animate()};b.prototype.buildScene=function(){var m,h,k,f,j,c,d,e,l,g,i=this;c=new Date();this.lastLoop=0;this.thisLoop=0;this.fps=0;this.numBadFps=0;this.camera;this.scene;this.renderer;this.stats;this.lightAmb;this.lightSpot;this.factors=[];this.balls=[];this.balls3d=[];this.numBalls=this.organism.getNodes().length;this.sphereSize=500;this.frame=0;this.mouseX=0;this.mouseY=0;this.mouseStartX=0;this.mouseStartY=0;this.mouseDX=0;this.mouseDY=0;this.mouseDown=false;this.keyLeft=false;this.keyRight=false;this.keyUp=false;this.keyDown=false;this.renderer=new THREE.WebGLRenderer({alpha:false,antialias:true});this.renderer.setSize(window.innerWidth,window.innerHeight);this.renderer.clearColor=16716176;this.scene=new THREE.Scene();this.camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,20000);this.camera.position=new THREE.Vector3(1,0.25,1).multiplyScalar(this.opts.cameraDistanceStart);this.camera.target=new THREE.Vector3(0,0,0);this.camera.lookAt(this.camera.target);this.camera.setLens(35);this.stats=new Stats();$(this.stats.domElement).attr("id","fps-stats");container.appendChild(this.stats.domElement);this.lightAmb=new THREE.AmbientLight(11184810);this.scene.add(this.lightAmb);this.lightSpot=new THREE.DirectionalLight(11184810,0.7);this.lightSpot.position.set(0,1,1);this.scene.add(this.lightSpot);this.lightSpot2=new THREE.DirectionalLight(11184810,0.5);this.lightSpot2.position.set(0.3,1,-1);this.scene.add(this.lightSpot2);d=this.opts.roomColor.clone();this.room=new THREE.Mesh(new THREE.SphereGeometry(this.opts.roomSize,this.opts.roomVertices,this.opts.roomVertices/2),new THREE.MeshPhongMaterial({ambient:d,side:THREE.BackSide,shading:THREE.FlatShading,blending:THREE.AdditiveBlending,vertexColors:THREE.VertexColors}));this.setDaylight();this.scene.add(this.room);setInterval(function(){return i.state.shouldSetDaylight=true},60000);this.centerBall=new THREE.Mesh(new THREE.TetrahedronGeometry(10,0),new THREE.MeshLambertMaterial({ambient:3346807,side:THREE.DoubleSide}));m=new THREE.SpriteMaterial({map:new THREE.ImageUtils.loadTexture("img/glow.png"),useScreenCoordinates:false,color:2236962,transparent:false,blending:THREE.AdditiveBlending});h=new THREE.Sprite(m);h.scale.set(50,50,1);this.centerBall.add(h);this.scene.add(this.centerBall);g=this.organism.getFactors();for(e=0,l=g.length;e<l;e++){k=g[e];j=new THREE.Color();j.setHSL(k.factorType/this.organism.getFactors().length,0.6,0.7);f=new THREE.Mesh(new THREE.CylinderGeometry(50,0,k.factorValue*3),new THREE.MeshLambertMaterial({ambient:j,side:THREE.FrontSide}));f.position.set(randomInt(0,1)===1?randomInt(-800,-600):randomInt(600,800),0,randomInt(0,1)===1?randomInt(-800,-600):randomInt(600,800));f.userData={isModifying:false,startPosition:f.position.clone(),hover:true,hoverStartFrame:0,initialValue:k.factorValue,baseColor:f.material.ambient.clone()};f.dynamic=true;this.factors[k.factorType]=f;this.scene.add(f)}this.orbitControls=new THREE.OrbitControls(this.camera,this.renderer.domElement);this.orbitControls.autoRotate=true;this.orbitControls.autoRotateSpeed=-1;return $("#canvas-wrap").css("opacity",0).append(this.renderer.domElement).fadeTo(1000,1)};b.prototype.animate=function(){var r,p,n,o,m,d,t,s,h,f,e,c,u,x,w,v,k,l,j,i,g,q=this;requestAnimationFrame(Audanism.Graphic["public"].animate);this.thisLoop=new Date();if(this.lastLoop>0){this.fps=1000/(this.thisLoop-this.lastLoop)}else{this.fps=60}this.lastLoop=this.thisLoop;if(this.fps<20){this.numBadFps++;EventDispatcher.trigger("audanism/performance/badfps",this.fps)}else{this.numBadFps=0;EventDispatcher.trigger("audanism/performance/goodfps",this.fps)}if(this.numBadFps>=5){EventDispatcher.trigger("audanism/performance/bad",this.fps)}this.frame++;EventDispatcher.trigger("audanism/graphic/update",this.frame);if(this.state.shouldSetDaylight){this.setDaylight();this.state.shouldSetDaylight=false}k=function(A){var z,y;z=q.organism.getFactorOfType(A);y=q.factors[A];y.userData.hover=false;y.userData.isModifying=true;return q._tweenSomething(y.position,{y:y.position.y},{y:(1000-z.disharmony)/2},1000,function(){y.userData.startPosition=y.position.clone();y.userData.hover=true;return y.userData.isModifying=false})};l=this.organism.getFactors();for(h=0,u=l.length;h<u;h++){n=l[h];o=this.factors[n.factorType];if(!o.userData.isModifying&&this.frame>10){k(n.factorType)}else{if(o.userData.hover){o.position.y=o.userData.startPosition.y+200*Math.sin((this.frame-o.userData.hoverStartFrame)/(10*n.factorValue))}}}j=this.balls;for(f=0,x=j.length;f<x;f++){r=j[f];if(r.ball3d.userData.hover){r.ball3d.position.y=r.ball3d.userData.startPosition.y+Math.sin(r.hoverPhase+(this.frame-r.ball3d.userData.hoverStartFrame)*r.hoverSpeed)*15}}if(this.instaCubes!=null){this._updateInstaCubes()}if(this.newCubes.length>0){i=this.newCubes;for(e=0,w=i.length;e<w;e++){p=i[e];this.cubes.push(p);this.scene.add(p);d=new THREE.Geometry();d.vertices.push(new THREE.Vector3(0,0,0));d.vertices.push(p.position.clone());t=new THREE.LineBasicMaterial({color:14880858,opacity:0.3});m=new THREE.Line(d,t);this.scene.add(m);p.userData.cubeLine=m}this.newCubes=[]}g=this.megaCubes;for(c=0,v=g.length;c<v;c++){s=g[c];s.rotation.x+=0.003;s.rotation.z+=0.0007}if(this.frame%10===1){this.room.material.ambient.offsetHSL(0.0001,0,0)}TWEEN.update();this.stats.update();this.orbitControls.update();return this.renderer.render(this.scene,this.camera)};b.prototype.addToQueue=function(d,c){return this.queue.push({fn:d,args:c})};b.prototype.runQueue=function(){var g,f,d,e,c;e=this.queue;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(g.fn.call(this,g.args))}return c};b.prototype.onIteration=function(x){var t,k,d,j,l,y,n,r,h,q,u,p,v,o,g,e,c,w,A,z,m,i,f,s=this;u=x.organism;l=u.getDisharmonyHistoryData();if(l.length===0){return}l=l[l.length-1];if(!(this.opts.initialDisharmonyData!=null)){this.opts.initialDisharmonyData=l}p=u.getDisharmonyChange(10,"actual");this.largestDistance=0;m=this.balls;for(g=0,w=m.length;g<w;g++){t=m[g];if(this.frame%4===0){h=t.pos.clone();h.multiplyScalar(p);v=t.ball3d.position.clone();o={x:h.x,y:h.y,z:h.z};t.ball3d.userData.hover=false;this._tweenSomething(t.ball3d.position,v,o,100,function(){return t.ball3d.userData.hover=true})}if(t.ball3d.position.length()>this.largestDistance){this.largestDistance=t.ball3d.position.length()}}this._tweenCameraDistance(this.largestDistance*(this.opts.cameraDistanceStart/this.opts.clusterSize));i=this.organism.getNodes();f=[];for(e=0,A=i.length;e<A;e++){q=i[e];j=q.getCells();t=this.balls[q.nodeId];if(this.frame-t.ball3d.userData.bornAt>30){n=0;for(c=0,z=j.length;c<z;c++){d=j[c];n+=u.getDisharmonyChangeForFactor(d.factorType,20)}y=n/j.length;r=Math.min(Math.pow(y,2),10);k={x:r,y:r,z:r};f.push(this._tweenSomething(t.ball3d.scale,t.ball3d.scale.clone(),k,200))}else{f.push(void 0)}}return f};b.prototype.setDaylight=function(){var e,g,d,c,f;c=new Date();f=this.opts.roomColor.clone();d=c.getHours()*60+c.getMinutes();g=d>720?d-720:720-d;e=0.5*g/720;console.log("darken",e);console.log("minutes from midday",g);f.offsetHSL(0,0,-e);return this.room.material.ambient=f};b.prototype.createBalls=function(c){var d,k,l,g,j,f,h,e;e=[];for(j=f=0,h=c-1;0<=h?f<=h:f>=h;j=0<=h?++f:--f){d={ballId:this.balls.length,hello:"hello. i am ball no "+j+".",direction:new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),ballSize:this.opts.ballSize,hoverPhase:Math.random()*Math.PI*2,hoverSpeed:1/(50+Math.random()*100),state:{numInfluenced:0,hover:true},ref:{numInfluenced:0}};d.pos=new THREE.Vector3(d.direction.x*Math.random()*this.opts.clusterSize,d.direction.y*Math.random()*this.opts.clusterSize,d.direction.z*Math.random()*this.opts.clusterSize);d.currPos=d.pos.clone();d.changes={};l=new THREE.SphereGeometry(d.ballSize,20,10);g=[new THREE.MeshLambertMaterial({ambient:this.opts.ballColor.clone(),side:THREE.DoubleSide,shading:THREE.FlatShading,blending:THREE.AdditiveBlending,vertexColors:THREE.VertexColors}),new THREE.MeshPhongMaterial({color:16777215,specular:16755370})];k=new THREE.Mesh(l,g[0]);k.ballId=d.ballId;k.position=d.pos.clone();k.userData.hover=true;k.userData.startPosition=k.position.clone();k.userData.hoverStartFrame=0;k.userData.bornAt=this.frame;k.scale.set(0,0,0);this.scene.add(k);this._tweenSomething(k.scale,{x:0,y:0,z:0},{x:1,y:1,z:1},1000);this.balls[d.ballId]=d;e.push(d.ball3d=k)}return e};b.prototype.onCompareNodes=function(h){var e,g,d,f,c;f=h.nodes;c=[];for(g=0,d=f.length;g<d;g++){e=f[g];c.push(this._animateComparingBall(this.balls[e.nodeId]))}return c};b.prototype._animateComparingBall=function(f){var d,h,c,e,g=this;e=f.ball3d.material.ambient;d=e.clone();h={r:this.opts.ballColorCompare.r,g:this.opts.ballColorCompare.g,b:this.opts.ballColorCompare.b};this._tweenBallColor(f,d.clone(),this.opts.ballColorCompare.clone(),200,function(){return g._tweenBallColor(f,g.opts.ballColorCompare.clone(),d.clone(),500)});f.state.hover=false;c={x:f.ball3d.position.x+(Math.random()*2-1)*15,y:f.ball3d.position.y+(Math.random()*2-1)*15,z:f.ball3d.position.z+(Math.random()*2-1)*15};return this._tweenSomething(f.ball3d.position,f.ball3d.position.clone(),c,30,function(){f.currPos=f.ball3d.position.clone();return f.state.hover=true})};b.prototype.onInfluenceNode=function(c){var d=this;if(!c.node.node){return}this._animateInfluencedBall(this.balls[c.node.node.nodeId]);if(c.meta.current===1&&(c.meta.source!=null)&&c.meta.source==="instagram"){this._spawnInstaCube.bind(this);return setTimeout(function(){return d._spawnInstaCube(c)},500)}};b.prototype.onInfluenceFactorAfter=function(g){var f,e,d,c,h=this;f=g.factor.factor;e=this.factors[f.factorType];e.userData.hover=false;e.userData.isModifying=true;c=function(){var l,o,j,k,i,m,n;if(!e.userData.toruses){e.userData.toruses=[]}l=e.userData.toruses;i=20;n=10;if(l.length>0){o=l[l.length-1];k=o.material.ambient.clone();m=o.geometry.radius;n=o.geometry.tube}else{k=e.material.ambient.clone();m=e.geometry.radiusTop;n=n}k.offsetHSL(0.05,-0.1,0);m*=0.96;n*=0.9;j=new THREE.Mesh(new THREE.TorusGeometry(m,n),new THREE.MeshLambertMaterial({ambient:k,side:THREE.FrontSide}));j.position.y=(e.geometry.height/2)+(i+l.length*(i+n));j.rotation.x=Math.PI/2;j.scale.set(0,0,0);e.userData.toruses.push(j);e.add(j);h._tweenSomething(j.scale,{x:0,y:0,z:0},{x:1,y:1,z:1},1000);return e.userData.isModifying};e.scale.y=f.factorValue/e.userData.initialValue;if(g.meta.sourceAttr==="wind"){this._tweenSomething(e.rotation,{z:e.rotation.z},{z:g.factor.value},300,c)}else{if(g.meta.sourceAttr==="temperature"){d=e.userData.baseColor.clone();d.offsetHSL(0,g.factor.value/5,0);this._tweenSomething(e.material.ambient,e.material.ambient.clone(),d,300,c)}}return this._tweenSomething(e.position,e.position.clone(),{x:(randomInt(0,1)===1?-100:100),y:(1000-f.disharmony)/2},300,function(){e.userData.startPosition=e.position.clone();e.userData.hoverStartFrame=h.frame;return e.userData.hover=true})};b.prototype._animateInfluencedBall=function(g){var e,c,d,f,h=this;f=g.ball3d.material.ambient;e=f.clone();c={r:this.opts.ballColorInfluence.r,g:this.opts.ballColorInfluence.g,b:this.opts.ballColorInfluence.b};this._tweenSomething(f,f.clone(),this.opts.ballColorInfluence.clone(),200,function(){return h._tweenSomething(f,h.opts.ballColorInfluence.clone(),f.clone(),200,function(){var l,j,k,i;g.state.numInfluenced+=1;i=(g.state.numInfluenced%5)/5;g.currPos=g.ball3d.position.clone();g.state.hover=true;l=h.opts.ballColor.clone();l.lerp(h.opts.ballColorVeteran.clone(),i);h._tweenSomething(g.ball3d.material.ambient,g.ball3d.material.ambient.clone(),{r:l.r,g:l.g,b:l.b},10);if(i===0){k=3*g.ball3d.geometry.radius;j=new THREE.Mesh(new THREE.CylinderGeometry(k,k,1),new THREE.MeshLambertMaterial({ambient:g.ball3d.material.ambient.clone(),transparent:true,opacity:0.3,side:THREE.DoubleSide}));j.rotation.x=(g.state.numInfluenced/5)*(Math.PI/4);return g.ball3d.add(j)}})});g.ball3d.userData.hover=false;d={x:g.ball3d.position.x+(Math.random()*2-1)*300,y:g.ball3d.position.y+(Math.random()*2-1)*300,z:g.ball3d.position.z+(Math.random()*2-1)*300};return this._tweenSomething(g.ball3d.position,g.ball3d.position.clone(),d,200,function(){g.ball3d.userData.hoverStartFrame=h.frame;g.ball3d.userData.startPosition=g.ball3d.position.clone();return g.ball3d.userData.hover=true})};b.prototype._spawnInstaCube=function(e){var c,d,g,f;d=new THREE.CubeGeometry(30,30,30);f=[new THREE.MeshLambertMaterial({ambient:924449,side:THREE.DoubleSide})];c=new THREE.Mesh(d,f[0]);c.position.set((1-2*Math.random())*this.opts.clusterSize*0.5*(1.5-Math.random()),(1-2*Math.random())*this.opts.clusterSize*(1.5-Math.random()),(1-2*Math.random())*this.opts.clusterSize*(1.5-Math.random()));c.rotation.set(Math.random(),Math.random(),Math.random());if(!(this.instaCubes!=null)){this.instaCubes=[]}g={cube:c,posStart:c.position.clone(),phase:Math.random()*Math.PI*2,hoverSpeed:1/(0.01+Math.random()*80),rotateSpeed:1/(10+Math.random()*40)};this.instaCubes.push(g);this.newCubes.push(c);if(this.instaCubes.length>this.opts.groupCubesEvery&&this.instaCubes.length%this.opts.groupCubesEvery===1){return this._replaceCubesWithMegaCube()}};b.prototype._replaceCubesWithMegaCube=function(){var c,e,j,k,h,f,m,d,g,i,l;c=new THREE.Color();c.setHSL(Math.random(),0.2,0.2);j=new THREE.IcosahedronGeometry(200);h=new THREE.MeshLambertMaterial({ambient:c,side:THREE.DoubleSide});m=new THREE.Mesh(j,h);d=new THREE.Vector3(this.opts.roomSize/2-200,this.opts.roomSize/2-200,this.opts.roomSize/2-200);d.applyAxisAngle(new THREE.Vector3(1,0,0),Math.random()*2*Math.PI);d.applyAxisAngle(new THREE.Vector3(0,1,0),Math.random()*2*Math.PI);d.applyAxisAngle(new THREE.Vector3(0,0,1),Math.random()*2*Math.PI);m.position=d;if(!(this.megaCubes!=null)){this.megaCubes=[]}this.megaCubes.push(m);this.scene.add(m);f=this.cubesGrouped;e=this.cubesGrouped+this.opts.cubesPerGroup;g=this.instaCubes.slice(f,e);for(i=0,l=g.length;i<l;i++){k=g[i];this._removeCube(k,d.clone(),m)}return this.cubesGrouped+=e-f};b.prototype._removeCube=function(e,c,g){var d,f,h=this;e.cube.add(e.cube.userData.cubeLine);d=e.cube.position;f=d.clone();f.multiplyScalar(100);return this._tweenSomething(d,d.clone(),c,1000,function(){e.cube.userData.cubeLine.material.color=0;g.add(e.cube.userData.cubeLine);return h.scene.remove(e.cube)})};b.prototype._updateInstaCubes=function(){var e,g,d,f,c;f=this.instaCubes;c=[];for(g=0,d=f.length;g<d;g++){e=f[g];c.push(e.cube.rotation.x+=e.rotateSpeed)}return c};b.prototype._tweenBall=function(e,g,f,d){var c;d=d||300;c=new TWEEN.Tween(g).to(f,d);this.tweens.push(c);c.easing(TWEEN.Easing.Quadratic.InOut);c.onUpdate(function(){return e.ball3d.position.set(this.x,this.y,this.z)});return c.start()};b.prototype._tweenBallSize=function(e,h,g,d,f){var c;c=new TWEEN.Tween({from:h}).to(g,d);this.tweens.push(c);c.easing(TWEEN.Easing.Linear.None);c.onUpdate(function(){return e.ball3d.scale.set(this.x,this.y,this.z)});return c.start()};b.prototype._tweenCameraDistance=function(e){var c,d;d=this;c=new TWEEN.Tween({distance:this.opts.cameraDistance}).to({distance:e},400);this.tweens.push(c);c.easing(TWEEN.Easing.Quadratic.InOut);c.onUpdate(function(){return d.opts.cameraDistance=this.distance});return c.start()};b.prototype._tweenBallColor=function(h,d,f,g,j){var e,i,c;e={r:d.r,g:d.g,b:d.b};i={r:f.r,g:f.g,b:f.b};c=new TWEEN.Tween(e).to(i,g).easing(TWEEN.Easing.Quadratic.InOut);this.tweens.push(c);c.onUpdate(function(){if(h.ball3d.children.length>0){return h.ball3d.children[0].material.ambient.setRGB(this.r,this.g,this.b)}else{return h.ball3d.material.ambient.setRGB(this.r,this.g,this.b)}});if(j){c.onComplete(j)}return c.start()};b.prototype._tweenColor=function(c,e,g,h,j){var f,i,d;f={r:e.r,g:e.g,b:e.b};i={r:g.r,g:g.g,b:g.b};d=new TWEEN.Tween(f).to(i,h).easing(TWEEN.Easing.Quadratic.InOut);this.tweens.push(d);d.onUpdate(function(){return c.setRGB(this.r,this.g,this.b)});if(j){d.onComplete(j)}return d.start()};b.prototype._tweenSomething=function(c,h,g,e,f){var d;d=new TWEEN.Tween(h).to(g,e).easing(TWEEN.Easing.Quadratic.InOut);this.tweens.push(d);d.onUpdate(function(){var k,m,j,l,i;l=Object.keys(this);i=[];for(m=0,j=l.length;m<j;m++){k=l[m];i.push(c[k]=this[k])}return i});if(f){d.onComplete(f)}return d.start()};return b})();window.Audanism.Graphic.VisualOrganism=a}).call(this);